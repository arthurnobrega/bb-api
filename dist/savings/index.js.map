{"version":3,"sources":["../../src/savings/index.js"],"names":["BBSavings","accountsUrl","BASE_ENDPOINT","headers","DEFAULT_HEADERS","cookie","LoginCookie","getGlobal","response","text","json","JSON","parse","sessions","conteiner","telas","sessoes","title","cabecalho","variations","celulas","map","c","acao","split","splice","BBSavingsAccount","variation","parseInt","v","description"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;;;IAEqBA,S;;;;;;;;;;;;;;AAEXC,2B,GAAc,gC;;uBAEG,8BAASC,wBAAT,GAAyBD,WAAzB,EAAwC;AAC7DE,sDACKC,0BADL;AAEEC,4BAAQC,sBAAYC,SAAZ;AAFV;AAD6D,iBAAxC,C;;;AAAjBC,wB;;uBAOaA,SAASC,IAAT,E;;;AAAbA,oB;AACAC,oB,GAAOC,KAAKC,KAAL,CAAWH,IAAX,C;AAEPI,wB,GAAWH,KAAKI,SAAL,CAAeC,KAAf,CAAqB,CAArB,EAAwBC,OAAxB,CAAgC,CAAhC,C;AACXC,qB,GAAQJ,SAASK,S;AACjBC,0B,GAAaN,SAASO,OAAT,CAAiBC,GAAjB,CACjB;AAAA,yBAAKC,EAAEC,IAAF,CAAOC,KAAP,CAAa,WAAb,EAA0BC,MAA1B,CAAiC,CAAC,CAAlC,EAAqC,CAArC,CAAL;AAAA,iBADiB,C;iDAIZN,WAAWE,GAAX,CACL;AAAA,yBACE,IAAIK,wBAAJ,CAAqB;AACnBC,+BAAWC,SAASC,CAAT,EAAY,EAAZ,CADQ;AAEnBC,iCAAgBb,KAAhB,0BAAoCY;AAFjB,mBAArB,CADF;AAAA,iBADK,C;;;;;;;;;;;;;;;;;;;;kBApBU7B,S","file":"index.js","sourcesContent":["import fetch from 'node-fetch';\nimport LoginCookie from '../loginCookie';\nimport { BASE_ENDPOINT, DEFAULT_HEADERS } from '../constants';\nimport BBSavingsAccount from './savingsAccount';\n\nexport default class BBSavings {\n  async getAccounts() {\n    const accountsUrl = 'tela/ExtratoDePoupanca/entrada';\n\n    const response = await fetch(`${BASE_ENDPOINT}${accountsUrl}`, {\n      headers: {\n        ...DEFAULT_HEADERS,\n        cookie: LoginCookie.getGlobal(),\n      },\n    });\n\n    const text = await response.text();\n    const json = JSON.parse(text);\n\n    const sessions = json.conteiner.telas[0].sessoes[0];\n    const title = sessions.cabecalho;\n    const variations = sessions.celulas.map(\n      c => c.acao.split('variacao=').splice(-1)[0],\n    );\n\n    return variations.map(\n      v =>\n        new BBSavingsAccount({\n          variation: parseInt(v, 10),\n          description: `${title} - Variação ${v}`,\n        }),\n    );\n  }\n}\n"]}