{"version":3,"sources":["../src/bb.js"],"names":["refreshHash","hashUrl","params","id","BASE_ENDPOINT","headers","DEFAULT_HEADERS","method","body","querystring","stringify","response","text","hash","BB","LoginCookie","setGlobal","getGlobal","branch","account","password","loginUrl","idh","dependenciaOrigem","numeroContratoOrigem","senhaConta","titularidade","apelido","idDispositivo","get","JSON","parse","login","checking","BBChecking","savings","BBSavings","creditCard","BBCreditCard"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA,IAAMA,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AACZC,YAAAA,OADY,GACF,MADE;AAEZC,YAAAA,MAFY,GAEH;AAAEC,cAAAA,EAAE,EAAE;AAAN,aAFG;AAAA;AAAA,mBAIK,qCAASC,wBAAT,SAAyBH,OAAzB,GAAoC;AACzDI,cAAAA,OAAO,EAAEC,0BADgD;AAEzDC,cAAAA,MAAM,EAAE,MAFiD;AAGzDC,cAAAA,IAAI,EAAEC,wBAAYC,SAAZ,CAAsBR,MAAtB;AAHmD,aAApC,CAJL;;AAAA;AAIZS,YAAAA,QAJY;AAAA;AAAA,mBAUCA,QAAQ,CAACC,IAAT,EAVD;;AAAA;AAUZC,YAAAA,IAVY;AAAA,6CAYXA,IAZW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAXb,WAAW;AAAA;AAAA;AAAA,GAAjB;;IAeqBc,E;;;AAOnB,gBAAc;AAAA;AAAA,uDANH,IAMG;AAAA,sDAJJ,IAII;AAAA,yDAFD,IAEC;;AACZC,4BAAYC,SAAZ;AACD;;;;iCAEY;AACX,aAAO,CAAC,CAACD,wBAAYE,SAAZ,EAAT;AACD;;;;;;;;;;;;;AAEaC,gBAAAA,M,SAAAA,M,EAAQC,O,SAAAA,O,EAASC,Q,SAAAA,Q;AACvBC,gBAAAA,Q,GAAW,4B;;uBACErB,WAAW,E;;;AAAxBa,gBAAAA,I;AAEAX,gBAAAA,M,GAAS;AACboB,kBAAAA,GAAG,EAAET,IADQ;AAEbU,kBAAAA,iBAAiB,EAAEL,MAFN;AAGbM,kBAAAA,oBAAoB,EAAEL,OAHT;AAIbM,kBAAAA,UAAU,EAAEL,QAJC;AAKbM,kBAAAA,YAAY,EAAE,GALD;AAMbC,kBAAAA,OAAO,EAAE,mBANI;AAObC,kBAAAA,aAAa,EAAE;AAPF,iB;;uBAUQ,qCAASxB,wBAAT,SAAyBiB,QAAzB,GAAqC;AAC1DhB,kBAAAA,OAAO,EAAEC,0BADiD;AAE1DC,kBAAAA,MAAM,EAAE,MAFkD;AAG1DC,kBAAAA,IAAI,EAAEC,wBAAYC,SAAZ,CAAsBR,MAAtB;AAHoD,iBAArC,C;;;AAAjBS,gBAAAA,Q;;AAMNI,wCAAYC,SAAZ,CAAsBL,QAAQ,CAACN,OAAT,CAAiBwB,GAAjB,CAAqB,YAArB,CAAtB;;;uBAEmBlB,QAAQ,CAACC,IAAT,E;;;AAAbA,gBAAAA,I;8BACYkB,IAAI,CAACC,KAAL,CAAWnB,IAAX,C,EAAVoB,K,eAAAA,K;AAER,qBAAKC,QAAL,GAAgB,IAAIC,oBAAJ,EAAhB;AACA,qBAAKC,OAAL,GAAe,IAAIC,mBAAJ,EAAf;AACA,qBAAKC,UAAL,GAAkB,IAAIC,sBAAJ,EAAlB;kDAEON,K","sourcesContent":["import fetch from 'node-fetch';\nimport querystring from 'querystring';\nimport LoginCookie from './loginCookie';\nimport { BASE_ENDPOINT, DEFAULT_HEADERS } from './constants';\nimport BBChecking from './checking';\nimport BBSavings from './savings';\nimport BBCreditCard from './creditCard';\n\nconst refreshHash = async () => {\n  const hashUrl = 'hash';\n  const params = { id: '00000000000000000000000000000000' };\n\n  const response = await fetch(`${BASE_ENDPOINT}${hashUrl}`, {\n    headers: DEFAULT_HEADERS,\n    method: 'POST',\n    body: querystring.stringify(params),\n  });\n\n  const hash = await response.text();\n\n  return hash;\n};\n\nexport default class BB {\n  checking = null;\n\n  savings = null;\n\n  creditCard = null;\n\n  constructor() {\n    LoginCookie.setGlobal();\n  }\n\n  isLoggedIn() {\n    return !!LoginCookie.getGlobal();\n  }\n\n  async login({ branch, account, password }) {\n    const loginUrl = 'servico/ServicoLogin/login';\n    const hash = await refreshHash();\n\n    const params = {\n      idh: hash,\n      dependenciaOrigem: branch,\n      numeroContratoOrigem: account,\n      senhaConta: password,\n      titularidade: '1',\n      apelido: 'NickRandom.123456',\n      idDispositivo: '2131296671',\n    };\n\n    const response = await fetch(`${BASE_ENDPOINT}${loginUrl}`, {\n      headers: DEFAULT_HEADERS,\n      method: 'POST',\n      body: querystring.stringify(params),\n    });\n\n    LoginCookie.setGlobal(response.headers.get('set-cookie'));\n\n    const text = await response.text();\n    const { login } = JSON.parse(text);\n\n    this.checking = new BBChecking();\n    this.savings = new BBSavings();\n    this.creditCard = new BBCreditCard();\n\n    return login;\n  }\n}\n"],"file":"bb.js"}